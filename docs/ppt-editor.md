---
id: ppt-editor
title: PPT 编辑器说明
slug: /ppt-editor
---

LandPPT 的在线编辑器结合幻灯片管理、实时预览、CodeMirror 编辑、AI 助手、图床联动和导出分享。

## 界面布局

![image](https://img.pub/p/6d357a847626f1a55c13.png)

| 区域 | 描述 |
| ---- | ---- |
| **左侧幻灯片栏** | 卡片式缩略图，可拖拽排序、右键调用常用操作（编辑/复制/粘贴/插入/删除/导出单页）。缩略图 iframe 固定 16:9，确保预览真实。 |
| **中部预览区** | 1280×720 的实时 iframe，支持左右导航、滚轮切换、放映模式（全屏切换/左右箭头）。 |
| **右侧编辑区** | CodeMirror 提供 HTML/CSS/JS 编辑、主题切换、查找替换（Ctrl+F、Ctrl+H）、括号匹配等能力。 |
| **顶部工具栏** | 包含保存、撤销/重做、模式切换、演示、导出 PPTX（可选图片版）、下载 HTML、分享链接等按钮。 |
| **AI 侧栏** | 点击机器人图标唤出，支持拖动调节宽度，提供聊天、上传参考图、自动修复布局、自动配图等功能。 |

## 幻灯片管理

- **拖拽排序**：按住缩略图即可重排，拖拽时半透明显示目标位置。
- **批量操作**：支持多选后统一删除/复制；配合模板快速创建多页。
- **插入方式**：
  - 空白页：生成基础 HTML，占位符为 `{{ title }}` `{{ content }}` 等。
  - AI 生成：基于当前大纲/需求自动生成整页内容。
  - 模板派生：从模板管理页面复制 HTML 后粘贴。
- **右键菜单**：包含编辑、复制、粘贴、插入新页、重新生成、导出单页 HTML、删除等选项。

## AI 编辑助手

- **对话模式**：输入自然语言（如“调成双栏布局”“插入对比表格”“标题换成蓝色”），AI 会返回代码片段或直接修改当前页。
- **上传参考图**：支持多文件上传，AI 会参考图片配色/结构；进度条实时展示上传状态。
- **视觉模式**：允许 AI 获取当前幻灯片截图，以更准确地提出改动建议。
- **快捷按钮**：
  - 查看当前页大纲（Structure）
  - 自动修复排版（Layout Repair）
  - 一键配图（Auto Images）——会调用图床+AI 图像
  - 重新生成当前幻灯片
  - 清除上下文
- **侧栏调整**：拖拽右侧把手改变宽度；支持 Esc 关闭。

## 图床联动

- 点击「插入图片」会弹出 `image-select-menu`，可选择“本地上传”或“从图床选择”：
  - 本地上传：上传后自动写入图床并返回 URL。
  - 图床选择：打开图库 overlay，支持搜索、分页、批量勾选并插入。
- 插入后的图片可在“全屏图片预览”里查看、下载或删除。
- 建议配合 [图床服务说明](./image-gallery.md) 中的分类、标签规范，以便 AI 快速命中素材。

## 编辑与预览技巧

- `Ctrl+S` 保存、`Ctrl+Z/Ctrl+Y` 撤销/重做、`Ctrl+F/Ctrl+H` 查找/替换、`Ctrl+A`（聚焦幻灯片列表时）全选幻灯片。
- 预览区域自动根据容器大小缩放，若需全尺寸可进入放映模式。
- 每次保存会调用 `setSafeIframeContent`，自动清理 `integrity/crossorigin` 并复用 Chart.js，减少闪烁。
- 复杂页面建议合并 CSS、减少外部脚本引用，并关闭视觉模式降低浏览器负载。

## 导出与分享

- **标准 PPTX 导出**：生成可编辑 PPTX（需配置 `APRYSE_LICENSE_KEY`）。
- **图片 PPTX 导出**：将每页渲染为图片再写入 PPTX，适合锁定视觉。
- **HTML 下载**：`downloadHTML()` 会生成包含所有幻灯片的 HTML，适合静态托管。
- **分享链接**：`showShareDialog()` 生成只读链接，可附带分享码/有效期。
- **放映模式**：`slideshowOverlay` 提供轻量播放界面，方向键或按钮切换，右上角退出。

## 常见问题

- **AI 建议未生效？** 确认是否切换到了正确的幻灯片；必要时点击「重新生成」或清空上下文。
- **预览空白？** 检查 HTML 是否缺少 `<html>` 结构、JS 是否报错、引用是否跨域。
- **粘贴 HTML 失真？** 模板需遵循 1280×720 布局，且使用相对路径/内联资源。
- **导出 PPTX 失败？** 检查 Apryse License、磁盘权限以及图床中是否存在失效 URL。

结合编辑器和 AI 助手，你可以在一个界面内完成从结构规划、视觉微调到导出分享的全流程，并与模板管理、图床服务等模块协同配合，快速迭代高质量演示文稿。
